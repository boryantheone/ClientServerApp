<!DOCTYPE html>
<html lang="ru">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>BookShop</title>
	<link rel="icon" type="image/png" href="img/favicon.png">
	<base href="/">
	<link rel="stylesheet" type="text/css" href="index.css">
	<link rel="stylesheet" type="text/css" href="./components/Footer/Footer.css">
	<link rel="stylesheet" type="text/css" href="admin_style.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

</head>

<body>
	<div class="admin_header">
		<div class="header-container">
			<div class="header-container__logo">
				<p><img src="components/Header/img/book.png" width="42" height="42" alt="">
					<big>–î–æ–±—Ä–µ–π—à–∏–µ –∫–Ω–∏–∂–∫–∏</big>
				</p>
			</div>
			<p>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</p>
			<p><a href="index.html">–í—ã–π—Ç–∏</a></p>
		</div>
	</div>
	<div class="admin_main">
		<div class="admin_panel">
			<p>–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
			<!-- <p>–í–≤–µ–¥–∏—Ç–µ —Ç–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p> -->
			<input class="input_to" id="input_to" type="text">
			<button class="users_button" id="reg_button">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
			<button class="users_button" id="ed_button">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–º—è –∞–∫–∫–∞—É–Ω—Ç–∞</button>
			<button class="users_button" id="del_button">–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
		</div>
		<div class="admin_list">
			<ul class="list_users">–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</ul>
		</div>

	</div>
	<div class="admin-footer">
		<div class="footer">
			<div class="footer-info">
				<h5><big>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</big></h5>
				<p>üìö–î–æ–±—Ä–µ–π—à–∏–µ –∫–Ω–∏–∂–∫–∏üìö</p>
				<p>‚ñ™Ô∏è555 50-—è —É–ª–∏—Ü–∞</p>
				<p>‚ñ™Ô∏è–¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω, –ö–∞–∑–∞–Ω—å 28801</p>
				<p>‚ñ™Ô∏è89534086854</p>
				<p>‚ñ™Ô∏èbookshop@mail.ru</p>
			</div>
			<div class="footer-contact">
				<h5><big>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞–º –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö</big></h5>
				<ul class="footer-social-icons">
					<li><a class="footer-social-icon-vk" href="#" title="..." target="_blank" rel="noopener"><img
								src="components/Footer/img/vk.png"></a></li>
					<li><a class="footer-social-icon-telegram" href="#" title="..." target="_blank" rel="noopener"><img
								src="components/Footer/img/tg.png"></a></li>
				</ul>
			</div>
		</div>
	</div>
	<script>
		$(document).ready(function () {
			$("#reg_button").on("click", function () {
				var login = $(".input_to").val();
				var type = prompt("–í–≤–µ–¥–∏—Ç–µ —Ç–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");
				if (login != "") {
					if (type == "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å") {
						console.log("+");
						$.post("/users/admin/user/" + login, function (result) {
							console.log(result);
						}).done(function (response) {
							console.log(response);
							alert('–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω!');
						}).fail(function (jqXHR, textStatus, error) {
							console.log(error);
							if (jqXHR.status === 501) {
								alert("–¢–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!");
							} else {
								alert("–û—à–∏–±–∫–∞!" + jqXHR.status + " " + jqXHR.textStatus);
							}
						});
					} else if (type == "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä") {
						$.post("/users/admin/moder/" + login, function (result) {
							console.log(result);
						}).done(function (response) {
							console.log(response);
							alert('–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω');
						}).fail(function (jqXHR, textStatus, error) {
							console.log(error);
							if (jqXHR.status === 501) {
								alert("–¢–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!");
							} else {
								alert("–û—à–∏–±–∫–∞!" + jqXHR.status + " " + jqXHR.textStatus);
							}
						});
					}
					else if (type != "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å" | type != "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä") {
						alert("–û—à–∏–±–∫–∞! –¢–∞–∫–æ–π —Ç–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω! ");
					}
					document.getElementById("input_to").value = "";
					location.reload();
				}
			})
		});

		$(document).ready(function () {
			$("#del_button").on("click", function () {
				var login = $(".input_to").val();
				if (login != "") {
					if (login == "admin") {
						alert("–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!");
						document.getElementById("input_to").value = "";
						return;
					}
					alert("–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∏–º–µ–Ω–µ–º " + login + "?");
					$.ajax({
						'url': '/users/' + login,
						'type': 'DELETE',
					}).done(function (response) {
						console.log(response);
						alert('–ê–∫–∫–∞—É–Ω—Ç —É–¥–∞–ª–µ–Ω!');
					}).fail(function (jqXHR, textStatus, error) {
						console.log(error)
						alert("–û—à–∏–±–∫–∞!" + jqXHR.status + " " + jqXHR.textStatus);
					});
					document.getElementById("input_to").value = "";
					location.reload();
				}
			});
		});

		$(document).ready(function () {
			$("#ed_button").on("click", function () {
				var login = $(".input_to").val();
				var new_login = prompt("–î–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–æ–≤–æ–µ –∏–º—è ");
				if (login != "" && new_login !="") {
					$.ajax({
						'url': '/users/' + login + '/' + new_login,
						'type': 'PUT',
						'data': {'login': new_login}
					}).done(function (response) {
						console.log(response);
						alert('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑–º–µ–Ω–µ–Ω–æ!');
					}).fail(function (jqXHR, textStatus, error) {
						console.log(error)
						alert("–û—à–∏–±–∫–∞!" + jqXHR.status + " " + jqXHR.textStatus);
					});
					document.getElementById("input_to").value = "";
					location.reload();
				}
			});
		});


		$.get("/users/admin/users", function (users) {
			let users_catalog = [];
			console.log(users.length);
			if (users.length > 0){
				for (var i = users.length-1; i >= 0; i--){
					users_catalog.push(users[i]);
				}
				console.log(users_catalog);
				for (var i = users_catalog.length-1; i >= 0; i--){
					html = "";
					var html = $('<li>'+ users_catalog[i].login + "     " +users_catalog[i].pos + '</li>');
					$('.list_users').append(html);
					html = "";
				}
			} else {
				var html = $('<li>'+ "–ï—â–µ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π" +'</li>');
				$('.list_users').append(html);
			}
		});

	</script>
</body>

</html>